
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>ContentCompressionResistanceå’ŒContentHuggingè¯¦è§£ - å¤æ ‘æ­£èŒ‚</title>
  <meta name="author" content="æ¢ç‚œV">

  
  <meta name="description" content="åœ¨Auto Layoutçš„ä½¿ç”¨ä¸­ï¼Œæœ‰ä¸¤ä¸ªå¾ˆé‡è¦çš„å¸ƒå±€æ¦‚å¿µï¼šContent Compression Resistanceå’ŒContent Huggingï¼Œä»å­—é¢çš„ç¿»è¯‘æˆ‘ä»¬å¤§æ¦‚å¯ä»¥åˆ†åˆ«ç¿»è¯‘ä¸ºï¼šå‹ç¼©é˜»åŠ›ä»¥åŠå†…å®¹å¸é™„ã€‚ä½†æ˜¯å…‰ä»å­—é¢æ„æ€æ¥ç†è§£å¾ˆéš¾çŸ¥é“å®ƒä»¬å¦‚ä½•ä½¿ç”¨ä»¥åŠç¡®åˆ‡çš„è®¾è®¡æ„å›¾ã€‚ &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://summertreee.github.io/blog/2015/12/13/contentcompressionresistancehe-contenthuggingxiang-jie/">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/atom.xml" rel="alternate" title="å¤æ ‘æ­£èŒ‚" type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="/javascripts/libs/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="//fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="//fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  

</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">å¤æ ‘æ­£èŒ‚</a></h1>
  
    <h2>èŠ±æœ‰é‡å¼€æ—¥ï¼Œäººæ— å†å°‘å¹´.</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="è®¢é˜… RSS">RSS</a></li>
  
</ul>
  
<form action="https://www.google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="sitesearch" value="summertreee.github.io">
    <input class="search" type="text" name="q" results="0" placeholder="æœç´¢"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div>
<article class="hentry" role="article">
  
  <header>
    
      <h1 class="entry-title">ContentCompressionResistanceå’ŒContentHuggingè¯¦è§£</h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2015-12-13T17:07:53+08:00'><span class='date'>2015 å¹´12 æœˆ13 æ—¥</span> <span class='time'>5:07 pm</span></time>
        
           | <a href="#disqus_thread"
             data-disqus-identifier="http://summertreee.github.io">Comments</a>
        
      </p>
    
  </header>


<div class="entry-content"><p>åœ¨Auto Layoutçš„ä½¿ç”¨ä¸­ï¼Œæœ‰ä¸¤ä¸ªå¾ˆé‡è¦çš„å¸ƒå±€æ¦‚å¿µï¼š<code>Content Compression Resistance</code>å’Œ<code>Content Hugging</code>ï¼Œä»å­—é¢çš„ç¿»è¯‘æˆ‘ä»¬å¤§æ¦‚å¯ä»¥åˆ†åˆ«ç¿»è¯‘ä¸ºï¼š<code>å‹ç¼©é˜»åŠ›</code>ä»¥åŠ<code>å†…å®¹å¸é™„</code>ã€‚ä½†æ˜¯å…‰ä»å­—é¢æ„æ€æ¥ç†è§£å¾ˆéš¾çŸ¥é“å®ƒä»¬å¦‚ä½•ä½¿ç”¨ä»¥åŠç¡®åˆ‡çš„è®¾è®¡æ„å›¾ã€‚æˆ‘æœ€å¼€å§‹ä¹Ÿæ˜¯å¾ˆè¿·ç³Šè€Œä¸”åœ¨ä½¿ç”¨Auto Layoutçš„è¿‡ç¨‹ä¸­ä¹Ÿæ²¡æœ‰ä½¿ç”¨è¿‡å®ƒä»¬ï¼Œç›´åˆ°æœ€è¿‘ç¨ç¨ç ”ç©¶äº†ä¸€ä¸‹ï¼Œå‘ç°å®ƒä»¬çš„ä½œç”¨ç”šæ˜¯å·¨å¤§ï¼Œæ‰€ä»¥æˆ‘ä¸ºäº†åŠ æ·±è®°å¿†ï¼ŒæŠŠæˆ‘æœ€è¿‘å­¦ä¹ åˆ°çš„å…³äºå®ƒä»¬çš„æ¦‚å¿µåœ¨æ­¤ç¨ä½œæ•´ç†åŠ ä»¥è®°å½•ã€‚</p>

<blockquote><p>æ³¨ï¼šä»¥ä¸‹ä¸ºäº†è¡¨è¿°æ–¹ä¾¿ï¼Œå°†<code>Content Compression Resistance</code>è®°ä¸º<code>å‹ç¼©é˜»åŠ›</code>ï¼Œå°†<code>Content Hugging</code>è®°ä¸º<code>å†…å®¹å¸é™„</code>ã€‚</p></blockquote>

<!--more-->


<h4>Content Compression Resistance</h4>

<p><strong>å‹ç¼©é˜»åŠ›</strong>å±æ€§ä¸ºäº†è®°å¿†æ›´åŠ å½¢è±¡æˆ‘ä»¬å¯ä»¥æŠŠå®ƒç†è§£ä¸º<strong>ç¦»æˆ‘è¿œç‚¹ï¼Œä¸è®¸æŒ¤åˆ°æˆ‘</strong>ï¼Œå®ƒçš„ä¼˜å…ˆçº§ï¼ˆPriorityï¼‰è¶Šé«˜ï¼Œå®ƒçš„è¿™ç§æŠ—æŒ¤å‹çš„èƒ½åŠ›ä¹Ÿå°±è¶Šå¼ºï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ä»£ç åœ¨æ§ä»¶çš„æ°´å¹³æˆ–å‚ç›´æ–¹å‘ä¸Šåˆ†åˆ«è®¾ç½®1ï¼ˆæœ€ä½ä¼˜å…ˆçº§ï¼‰åˆ°1000ï¼ˆæœ€é«˜ä¼˜å…ˆçº§ï¼‰ä¹‹é—´çš„ä¼˜å…ˆçº§ï¼Œé»˜è®¤æ˜¯750ï¼Œä¾‹å¦‚æˆ‘ä»¬å¯ä»¥ä¸ºä¸€ä¸ª<strong>UILabel</strong>æ§ä»¶è®¾ç½®ä¸€ä¸ªå®ƒåœ¨æ°´å¹³æ–¹å‘ä¸Šä¼˜å…ˆçº§ä¸º<em>500</em>çš„å‹ç¼©é˜»åŠ›ï¼š</p>

<pre><code>[label setContentCompressionResistancePriority:500 forAxis:UILayoutConstraintAxisHorizontal];  
</code></pre>

<p>ç”¨å›¾æ¥è¡¨ç¤ºï¼Œæˆ‘ä»¬å¯ä»¥å¤§è‡´è¡¨ç¤ºå¦‚ä¸‹ï¼Œè§†å›¾çš„å‹ç¼©é˜»åŠ›å°±å¥½ä¼¼å®ƒè‡ªèº«å¾€å¤–çš„å¼ åŠ›ï¼Œä¼˜å…ˆçº§è¶Šé«˜ï¼Œè§†å›¾è‡ªå·±ç»´æŒè‡ªèº«æ˜¾ç¤ºå®Œæ•´æ€§çš„èƒ½åŠ›å°±è¶Šå¼ºï¼š</p>

<p><img src="http://ww1.sinaimg.cn/mw690/8f7a6fe0jw1eyqrwdofkoj208r08r74s.jpg" alt="image" /></p>

<h4>Content Hugging</h4>

<p><strong>å†…å®¹å¸é™„</strong>å±æ€§ä¸ºäº†è®°å¿†æ–¹ä¾¿æˆ‘ä»¬å¯ä»¥æŠŠå®ƒç†è§£ä¸º<strong>æŠ±ç´§ï¼ˆHugï¼‰</strong>ï¼Œè§†å›¾çš„å¤§å°ä¸ä¼šéšç€superViewçš„å˜å¤§è€Œæ‰©å¤§ï¼Œè€Œæ˜¯åªç»´æŒèƒ½å®Œå…¨æ˜¾ç¤ºè‡ªå·±å†…å®¹çš„å¤§å°ï¼Œå®ƒçš„è¿™ç§ä¼˜å…ˆçº§è¶Šé«˜ï¼Œå¸é™„çš„èƒ½åŠ›å°±è¶Šå¼ºï¼Œå’Œ<strong>å‹ç¼©é˜»åŠ›</strong>ä¸€æ ·ï¼Œ<strong>å†…å®¹å¸é™„</strong>çš„ä¼˜å…ˆçº§ä¹Ÿå¯ä»¥é€šè¿‡ä»£ç æ¥è®¾ç½®ï¼Œåªæ˜¯å®ƒçš„é»˜è®¤ä¼˜å…ˆçº§æ˜¯<em>250</em>ï¼š</p>

<pre><code>[label setContentHuggingPriority:251 forAxis:UILayoutConstraintAxisHorizontal];  
</code></pre>

<p>ç”¨å›¾æ¥è¡¨ç¤ºï¼Œæˆ‘ä»¬å¯ä»¥å¤§è‡´è¡¨ç¤ºå¦‚ä¸‹ï¼Œè§†å›¾çš„å†…å®¹å¸é™„å°±å¥½ä¼¼è§†å›¾è‡ªå·±æœ‰å‘å†…æŠ±ç´§è‡ªå·±çš„åŠ›é‡ä¸€æ ·ï¼Œä¼˜å…ˆçº§è¶Šé«˜ï¼Œå®ƒçš„è¿™ç§èƒ½åŠ›å°±è¶Šå¼ºï¼š</p>

<p><img src="http://ww1.sinaimg.cn/mw690/8f7a6fe0jw1eyqrwdllbej208n08mq3e.jpg" alt="image" /></p>

<p>ä»¥ä¸Šè®²äº†<code>å†…å®¹å¸é™„</code>å’Œ<code>å‹ç¼©é˜»åŠ›</code>çš„åŸºæœ¬æ¦‚å¿µï¼Œä½†æ˜¯è¿™ä¸¤ä¸ªå±æ€§æ˜¯å»ºç«‹åœ¨<code>Intrinsic Content Size</code>è¿™ä¸€æ¦‚å¿µä¸Šçš„ï¼Œæˆ‘ä»¬æš‚ä¸”æŠŠå®ƒç¿»è¯‘ä¸º<code>å›ºæœ‰å°ºå¯¸</code>ï¼Œæ‰€æœ‰åŸºäºUIViewçš„è§†å›¾éƒ½æœ‰<code>intrinsicContentSize</code>è¿™ä¸ªå±æ€§ï¼Œä¸‹é¢æˆ‘ä»¬å°±ä»‹ç»ä¸€ä¸‹ä»€ä¹ˆæ˜¯<code>å›ºæœ‰å°ºå¯¸</code>ã€‚</p>

<h4>Intrinsic Content Size</h4>

<p>æ¯ä¸ªè§†å›¾éƒ½æœ‰å‹ç¼©é˜»åŠ›ä¼˜å…ˆçº§ï¼ˆContent Compression Resistance Priorityï¼‰å’Œå†…å®¹å¸é™„ä¼˜å…ˆçº§ï¼ˆContent Hugging Priorityï¼‰ï¼Œä½†åªæœ‰è§†å›¾æ˜ç¡®äº†å®ƒçš„<code>å›ºæœ‰å°ºå¯¸</code>åï¼Œè¿™ä¸¤ç§ä¼˜å…ˆçº§æ‰ä¼šèµ·ä½œç”¨ã€‚æˆ‘ä»¬é¦–å…ˆæ¥çœ‹ä¸€ä¸‹å®˜æ–¹çš„è§£é‡Šï¼š</p>

<blockquote><p> Custom views typically have content that they display of which the layout system is unaware. Overriding this method allows a custom view to communicate to the layout system what size it would like to be based on its content. This intrinsic size must be independent of the content frame, because thereâ€™s no way to dynamically communicate a changed width to the layout system based on a changed height, for example.
If a custom view has no intrinsic size for a given dimension, it can return UIViewNoIntrinsicMetric for that dimension.</p></blockquote>

<p>å¤§è‡´çš„æ„æ€å°±æ˜¯æˆ‘ä»¬è‡ªå®šä¹‰çš„è§†å›¾åœ¨é»˜è®¤æƒ…å†µä¸‹ï¼Œå®ƒçš„å›ºæœ‰å°ºå¯¸æ˜¯è¿”å›(UIViewNoIntrinsicMetricï¼ŒUIViewNoIntrinsicMetric)ï¼Œä¹Ÿå°±æ˜¯(-1,-1)ï¼Œåªæœ‰æˆ‘ä»¬æ ¹æ®è‡ªå®šä¹‰è§†å›¾æœ¬èº«çš„Contentæ¥é‡å†™è¯¥æ–¹æ³•ï¼Œæˆ‘ä»¬è‡ªå®šä¹‰çš„è§†å›¾æ‰èƒ½æ˜ç¡®çš„çŸ¥é“ä»–åœ¨æ˜¾ç¤ºç³»ç»Ÿä¸­è¯¥å±•ç¤ºçš„å¤§å°ã€‚<br/>
UILabelå’ŒUIButtonç­‰è¿™äº›æ§ä»¶ï¼Œç³»ç»Ÿé»˜è®¤æ˜¯æ ¹æ®ä»–ä»¬çš„å†…å®¹å®ç°äº†å›ºæœ‰å°ºå¯¸ï¼Œæ‰€ä»¥æˆ‘ä»¬åœ¨ä½¿ç”¨çš„æ—¶å€™åªéœ€è¦ç¡®å®šoriginæˆ–è€…Centerå®ƒä»¬å°±èƒ½æ­£ç¡®çš„æ˜¾ç¤ºã€‚<br/>
ç”±æ­¤å¯è§ï¼Œå›ºæœ‰å°ºå¯¸æ˜¯ä¸ºäº†å®ç°è§†å›¾çš„<strong>å¤§å°è‡ªé€‚åº”</strong>è€Œå­˜åœ¨çš„ã€‚</p>

<p>ä»¥ä¸‹æˆ‘æ¥è‡ªå®šä¹‰ä¸€ä¸ªè§†å›¾ï¼Œæ¥æµ‹è¯•ä¸€ä¸‹<code>å›ºæœ‰å°ºå¯¸</code>æ˜¯å¦æœ‰æ•ˆï¼Œç”±äºé¡¹ç›®ä¸­å¤§å®¶éƒ½æ˜¯ç”¨<a href="http://https://github.com/SnapKit/Masonry">Masonry</a>æ¥å¤„ç†Auto Layoutï¼Œæ‰€ä»¥ä¸€ä¸‹çš„ä¾‹å­éƒ½ä½¿ç”¨<code>Masonry</code>æ¥å¸ƒå±€ã€‚</p>

<h5>é‡å†™Intrinsic Content Size</h5>

<p>æˆ‘ä»¬æ–°å»ºä¸€ä¸ªç»§æ‰¿è‡ª<code>UIView</code>çš„è‡ªå®šä¹‰è§†å›¾<code>IntrinsicView</code>ï¼Œåœ¨ä¸€ä¸ªViewControllerä¸­æ·»åŠ ä¸€ä¸ªæˆ‘ä»¬è‡ªå®šä¹‰çš„è§†å›¾,è®¾ç½®å®ƒæ°´å¹³å±…ä¸­ï¼Œé¡¶éƒ¨å’Œçˆ¶è§†å›¾å¯¹é½ã€‚</p>

<pre><code>- (void)layoutSubIntrinsicView
{
    IntrinsicView *intrinsicView = [IntrinsicView new];
    intrinsicView.backgroundColor = [UIColor colorWithRed:.2 green:.4 blue:.6 alpha:1];
    [self.view addSubview:intrinsicView];
    [intrinsicView mas_makeConstraints:^(MASConstraintMaker *make) {
    make.centerX.mas_equalTo(self.view);
    make.top.mas_equalTo(self.mas_topLayoutGuideBottom);
}];
}
</code></pre>

<p>è¿è¡Œåå‘ç°ä»€ä¹ˆä¹Ÿæ²¡æ˜¾ç¤ºï¼Œå› ä¸ºæˆ‘ä»¬æ²¡æœ‰è®¾ç½®å®ƒçš„å®½é«˜ï¼Œè€Œå®ƒé»˜è®¤çš„å›ºæœ‰å°ºå¯¸æ˜¯ï¼ˆ-1 ï¼Œ-1ï¼‰ã€‚æˆ‘ä»¬å»é‡å†™<code>IntrinsicView</code>çš„<code>- (CGSize)intrinsicContentSize</code>æ–¹æ³•ï¼š</p>

<pre><code>@implementation IntrinsicView

- (CGSize)intrinsicContentSize
{
    return CGSizeMake(150, 66);
}

@end  
</code></pre>

<p>è¿è¡Œåæ˜¾ç¤ºå¦‚ä¸‹ï¼š</p>

<p><img src="http://ww2.sinaimg.cn/mw690/8f7a6fe0jw1eyqrw65tsuj208y0ddaa5.jpg" alt="image" /></p>

<p>æ˜¾ç¤ºå‡ºæ¥ï¼Œå®ƒçš„å¤§å°åˆšå¥½æ˜¯æˆ‘ä»¬å®šä¹‰çš„<code>intrinsicContentSize</code>å¤§å°ã€‚ä¸Šé¢ä»‹ç»äº†å†…å®¹å¸é™„å’Œå‹ç¼©é˜»åŠ›ä»¥åŠå›ºæœ‰å°ºå¯¸çš„åŸºæœ¬æ¦‚å¿µï¼Œä¸‹é¢æ¥æµ‹è¯•ä¸€ä¸‹å®ƒä»¬åº”è¯¥å¦‚ä½•ä½¿ç”¨ã€‚</p>

<h6>1ã€æµ‹è¯•å†…å®¹å¸é™„ä¼˜å…ˆçº§</h6>

<p>ä¸ºäº†æµ‹è¯•å†…å®¹å¸é™„ä¼˜å…ˆçº§æˆ‘ä»¬åœ¨é¡µé¢ä¸Šæ·»åŠ ä¸¤ä¸ª<code>IntrinsicView</code>ï¼Œåˆ†åˆ«æ˜¯<code>topView</code>å’Œ<code>bottomView</code>ï¼Œè®¾ç½®ä»–ä»¬éƒ½æ°´å¹³å±…ä¸­ï¼Œç„¶ååˆ†åˆ«å’Œé¡µé¢çš„é¡¶éƒ¨å’Œåº•éƒ¨å¯¹é½ï¼š</p>

<pre><code>- (void)layoutSubIntrinsicView
{
    IntrinsicView *topView = [IntrinsicView new];
    topView.backgroundColor = [UIColor colorWithRed:.2 green:.4 blue:.6 alpha:1];
    [self.view addSubview:topView];
    [topView mas_makeConstraints:^(MASConstraintMaker *make) {
        make.centerX.mas_equalTo(self.view);
        make.top.mas_equalTo(self.mas_topLayoutGuideBottom);//å’Œå¯¼èˆªæ åº•éƒ¨å¯¹é½
    }];

    IntrinsicView *bottomView = [IntrinsicView new];
    bottomView.backgroundColor = [UIColor colorWithRed:.2 green:.4 blue:.6 alpha:1];
    [self.view addSubview:bottomView];
    [bottomView mas_makeConstraints:^(MASConstraintMaker *make) {
        make.centerX.mas_equalTo(self.view);
        make.bottom.mas_equalTo(self.mas_bottomLayoutGuideBottom);//å’Œé¡µé¢åº•éƒ¨å¯¹é½
    }];
}  
</code></pre>

<p>è¿è¡Œåå±•ç¤ºå¦‚ä¸‹ï¼š<br/>
<img src="http://ww3.sinaimg.cn/mw690/8f7a6fe0jw1eyqrw6ih8aj208w0ddglq.jpg" alt="image" /></p>

<p>ä¸‹é¢æˆ‘ä»¬è®¾ç½®<strong>topView</strong>å’Œ<strong>bottomView</strong>ä¹‹é—´çš„é—´è·ä¸º<em>40</em>ï¼Œä¹Ÿå°±æ˜¯<code>topView.bottom + 40 = bottomView.top</code>ã€‚</p>

<pre><code>- (void)layoutSubIntrinsicView
{
    IntrinsicView *topView = [IntrinsicView new];
    topView.backgroundColor = [UIColor colorWithRed:.2 green:.4 blue:.6 alpha:1];
    [self.view addSubview:topView];
    [topView mas_makeConstraints:^(MASConstraintMaker *make) {
        make.centerX.mas_equalTo(self.view);
        make.top.mas_equalTo(self.mas_topLayoutGuideBottom);//å’Œå¯¼èˆªæ åº•éƒ¨å¯¹é½
}];

    IntrinsicView *bottomView = [IntrinsicView new];
    bottomView.backgroundColor = [UIColor colorWithRed:.2 green:.4 blue:.6 alpha:1];
    [self.view addSubview:bottomView];
    [bottomView mas_makeConstraints:^(MASConstraintMaker *make) {
        make.centerX.mas_equalTo(self.view);
        make.top.mas_equalTo(topView.mas_bottom).offset(40);
        make.bottom.mas_equalTo(self.mas_bottomLayoutGuideBottom);//å’Œé¡µé¢åº•éƒ¨å¯¹é½
 }];
}  
</code></pre>

<p>è¿è¡Œåå±•ç¤ºæ•ˆæœå¦‚ä¸‹ï¼š</p>

<p><img src="http://ww1.sinaimg.cn/mw690/8f7a6fe0jw1eyqrw6xva7j208v0dcmxb.jpg" alt="image" /></p>

<p>æˆ‘ä»¬å‘ç°<code>topView</code>è¢«æ‹‰ä¼¸äº†ï¼Œå¦‚æœæˆ‘ä»¬ä¸æƒ³<code>topView</code>è¢«æ‹‰ä¼¸ï¼Œå°±å¯ä»¥åˆ©ç”¨<code>å†…å®¹å¸é™„</code>çš„ç‰¹æ€§ï¼Œå› ä¸ºæˆ‘ä»¬å®šä¹‰äº†<code>IntrinsicView</code>çš„å›ºæœ‰å°ºå¯¸ï¼Œè®¾ç½®<code>topView</code>çš„<code>å†…å®¹å¸é™„</code>ä¼˜å…ˆçº§æ¯”<code>bottomView</code>çš„ä¼˜å…ˆçº§é«˜ï¼Œæˆ‘ä»¬ä¸Šé¢ä»‹ç»äº†<code>å†…å®¹å¸é™„</code>çš„é»˜è®¤ä¼˜å…ˆçº§æ˜¯<em>250</em>ï¼Œæˆ‘ä»¬æŠŠ<code>topView</code>çš„<code>å†…å®¹å¸é™„</code>ä¼˜å…ˆçº§è®¾ç½®ä¸º<em>251</em>ï¼Œåœ¨åŸæ¥<code>layoutSubIntrinsicView</code>å‡½æ•°çš„æœ€åæ·»åŠ å¦‚ä¸‹è¯­å¥ï¼š</p>

<pre><code>[topView setContentHuggingPriority:251 forAxis:UILayoutConstraintAxisVertical];  
</code></pre>

<p>è¿è¡Œåå¦‚ä¸‹æ‰€ç¤ºï¼Œè¾¾åˆ°äº†æˆ‘ä»¬æƒ³è¦çš„æ•ˆæœï¼š</p>

<p><img src="http://ww2.sinaimg.cn/mw690/8f7a6fe0jw1eyqrw7a0tqj208w0ddt8v.jpg" alt="image" /></p>

<blockquote><p>251æ˜¯æˆ‘éšæ„å®šçš„æ¯”250å¤§çš„å€¼ï¼Œå¯ä»¥æ˜¯å¤§äº250å°äº1000çš„ä»»ä½•å€¼ã€‚</p></blockquote>

<h6>2ã€æµ‹è¯•å‹ç¼©é˜»åŠ›ä¼˜å…ˆçº§</h6>

<p>æˆ‘ä»¬é€šå¸¸ä¼šé‡åˆ°å¦‚ä¸‹å›¾æ‰€ç¤ºçš„éœ€æ±‚ï¼š</p>

<p><img src="http://ww1.sinaimg.cn/mw690/8f7a6fe0jw1eyqrw7yw9hj20e007cdgi.jpg" alt="image" /></p>

<p>åœ¨æŸä¸ªé¡µé¢ä¸Šæ°´å¹³æ”¾ç½®ä¸¤ä¸ªUILabelï¼Œ<code>leftLabel</code>çš„å·¦è¾¹å’Œçˆ¶è§†å›¾çš„é—´è·å›ºå®šï¼Œ<code>rightLabel</code>çš„å³è¾¹å’Œçˆ¶è§†å›¾çš„å³è¾¹æœ‰ä¸€ä¸ªå°äºç­‰äºæŸä¸ªé—´éš”çš„çº¦æŸï¼Œ<code>leftLabel</code>å’Œ<code>rightLabel</code>ä¹‹é—´æœ‰ä¸€ä¸ªå›ºå®šé—´è·ï¼Œå®ƒä»¬çš„å®½åº¦æ ¹æ®ä»–ä»¬æ˜¾ç¤ºçš„å†…å®¹è‡ªé€‚åº”ï¼Œå…³é”®ä»£ç å¦‚ä¸‹:</p>

<pre><code>[leftLabel mas_makeConstraints:^(MASConstraintMaker *make) {
    //å·¦è¾¹å’Œçˆ¶è§†å›¾é—´éš”å›ºå®šä¸º10
    make.left.mas_equalTo(self.view).offset(10);
    make.top.mas_equalTo(80);//éšæ„è®¾å®šçš„å€¼
}];

[rightLabel mas_makeConstraints:^(MASConstraintMaker *make) {
    make.top.mas_equalTo(leftLabel);
    //å’ŒleftLabelçš„å³è¾¹é—´è·å›ºå®šä¸º20
    make.left.mas_equalTo(leftLabel.mas_right).offset(20);
    //è¿™é‡Œæ³¨æ„æ˜¯â€˜lessThanOrEqualToâ€™ï¼Œä¹Ÿå°±æ˜¯â€˜rightLabelâ€™çš„å³è¾¹ç•Œ
    //å’Œçˆ¶è§†å›¾çš„é—´è·è‡³å°‘ä¸º10ï¼Œå†…å®¹å°‘æ—¶ï¼Œé—´è·è‡ªåŠ¨è°ƒå¤§
    make.right.mas_lessThanOrEqualTo(self.view).offset(-10);
}];  
</code></pre>

<p>åœ¨ä»–ä»¬çš„æ˜¾ç¤ºå†…å®¹å®½åº¦ä¸è¶…è¿‡çˆ¶è§†å›¾å®½åº¦æ—¶ï¼Œä¸¤ä¸ªlabelçš„å†…å®¹éƒ½èƒ½æ­£å¸¸çš„å®Œå…¨æ˜¾ç¤ºï¼Œä½†æ˜¯å½“å®ƒä»¬éœ€è¦æ˜¾ç¤ºçš„å†…å®¹é•¿åº¦æ€»å’Œè¶…è¿‡çˆ¶è§†å›¾çš„å®½åº¦æ—¶ï¼Œå°±ä¼šæ˜¾ç¤ºå¦‚ä¸‹ï¼š</p>

<p><img src="http://ww1.sinaimg.cn/mw690/8f7a6fe0jw1eyqrwckaf2j208x0ddglw.jpg" alt="image" /></p>

<p>ä¸€ä¸ªlabelè¢«å‹ç¼©äº†ï¼Œ <code>rightLabel</code>æ˜¾ç¤ºä¸å®Œå…¨ï¼Œå¦‚æœåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬æƒ³<code>leftLabel</code>è¢«å‹ç¼©ï¼Œè€Œ<code>rightLabel</code>å°½é‡å®Œå…¨æ˜¾ç¤ºï¼Œç”±äºUILabelè¿™ç±»æ§ä»¶ï¼Œç³»ç»Ÿè‡ªå·±å·²ç»æ ¹æ®å®ƒä»¬æ˜¾ç¤ºçš„å®é™…å†…å®¹å®ç°äº†<code>å›ºæœ‰å°ºå¯¸</code>çš„æ–¹æ³•ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨<code>å‹ç¼©é˜»åŠ›</code>çš„ç‰¹æ€§ï¼Œå°†<code>rightLabel</code>çš„<code>å‹ç¼©é˜»åŠ›</code>ä¼˜å…ˆçº§è®¾ç½®å¾—æ¯”<code>leftLabel</code>é«˜ï¼Œä¸Šé¢ä»‹ç»äº†<code>å‹ç¼©é˜»åŠ›</code>çš„é»˜è®¤ä¼˜å…ˆçº§æ˜¯<em>750</em>ï¼Œæˆ‘ä»¬æŠŠ<code>rightLabel</code>çš„ä¼˜å…ˆçº§è®¾ç½®ä¸º<em>751</em>ï¼Œåœ¨ä¸Šé¢ä»£ç çš„æœ€ä¸‹é¢æ·»åŠ å¦‚ä¸‹ä»£ç ï¼š</p>

<pre><code>[rightLabel setContentCompressionResistancePriority:751 forAxis:UILayoutConstraintAxisHorizontal];  
</code></pre>

<p>è¿è¡Œåæ˜¾ç¤ºå¦‚ä¸‹ï¼Œè¾¾åˆ°äº†æˆ‘ä»¬é¢„æœŸçš„æ•ˆæœï¼š</p>

<p><img src="http://ww3.sinaimg.cn/mw690/8f7a6fe0jw1eyqrwd0cbqj208x0dddg4.jpg" alt="image" /></p>

<h6>3ã€åœ¨è‡ªåŠ¨è®¡ç®—UITableViewCellé«˜åº¦ä¸­çš„ä½¿ç”¨</h6>

<p>å¯¹äºå˜é«˜cellçš„å¤„ç†ï¼Œä»¥å‰æˆ‘ä»¬éƒ½æ˜¯åœ¨<code>heightForRowAtIndexPath</code>æ–¹æ³•é‡Œé¢ï¼Œæ‹¼å‡‘è¦å±•ç¤ºçš„å˜é«˜cellçš„é«˜åº¦ï¼Œå½“æˆ‘ä»¬æ”¹å˜cellä¸­ä¸¤ä¸ªæ§ä»¶åœ¨å‚ç›´æ–¹å‘çš„å¸ƒå±€ï¼Œæˆ–è€…å†æ·»åŠ ä¸€ä¸ªæ§ä»¶æ—¶ï¼Œè¿˜è¦å»ä¿®æ”¹è®¡ç®—cellé«˜åº¦çš„æ–¹æ³•æ¥é€‚åº”æ–°çš„å˜åŒ–ï¼Œéå¸¸ä¸æ–¹ä¾¿ã€‚ä½†æ˜¯æœ‰äº†è‡ªåŠ¨å¸ƒå±€åï¼Œåˆ©ç”¨å¥½<code>å‹ç¼©é˜»åŠ›</code>å’Œ<code>å†…å®¹å¸é™„</code>çš„ä¼˜å…ˆçº§ï¼Œå¯ä»¥å¾ˆç²¾ç¡®å¾ˆç®€å•çš„ç”±ç³»ç»Ÿæ¥è®¡ç®—å‡ºå˜é«˜cellçš„é«˜åº¦ã€‚</p>

<p>å‡å®šæˆ‘ä»¬æœ‰å¦‚ä¸‹éœ€æ±‚ï¼š<br/>
<img src="http://ww3.sinaimg.cn/mw690/8f7a6fe0gw1eyvfxt9hqfj20e1097dgw.jpg" alt="image" /></p>

<p>æˆ‘ä»¬çœ‹åˆ°ï¼Œè¿™ä¸ªå˜é«˜cellé‡Œé¢é«˜åº¦ä¸å®šçš„æ˜¯ä¸­é—´çš„<code>ContentLabel</code>ï¼Œå®ƒä¼šæ ¹æ®å†…å®¹é•¿åº¦æ¥æŠ˜è¡Œæ˜¾ç¤ºï¼Œ<strong>UILabel</strong>è¦æŠ˜è¡Œæ˜¾ç¤ºæˆ‘ä»¬éœ€è¦è®¾ç½®å®ƒçš„<code>preferredMaxLayoutWidth</code>å’Œ<code>numberOfLines</code>ä¸¤ä¸ªå±æ€§çš„å€¼ã€‚</p>

<p>é¦–å…ˆå‡å®š<code>Model</code>çš„å®šä¹‰å¦‚ä¸‹ï¼š</p>

<pre><code>@interface CellModel : NSObject

@property (nonatomic, copy) NSString *name;
@property (nonatomic, copy) NSString *company;
@property (nonatomic, copy) NSString *content;
@property (nonatomic, assign) CGFloat cacheHeight;//ç¼“å­˜å½“å‰Modelæ˜¾ç¤ºçš„cellé«˜åº¦

@end
</code></pre>

<p>è‡ªå®šä¹‰çš„<code>UITableViewCell</code>çš„å…³é”®ä»£ç å¦‚ä¸‹ï¼š</p>

<pre><code>//å›¾ç‰‡è·å·¦è¾¹è·ç¦»ä¸º10ï¼Œä¸Šä¸‹å±…ä¸­
    [_cellImageView mas_makeConstraints:^(MASConstraintMaker *make) {
        make.left.mas_equalTo(self.contentView).offset(10);
        make.centerY.mas_equalTo(self.contentView);
        make.top.mas_greaterThanOrEqualTo(self.contentView).offset(10);
        make.bottom.mas_lessThanOrEqualTo(self.contentView).offset(-10);
    }];
    //æ ‡é¢˜Label,ä¸€è¡Œæ˜¾ç¤º
    [_nameLabel mas_makeConstraints:^(MASConstraintMaker *make) {
        make.left.mas_equalTo(self.cellImageView.mas_right).offset(6);
        make.right.mas_lessThanOrEqualTo(self.contentView).offset(-10);
        make.top.mas_equalTo(self.contentView).offset(10);
    }];
    //å†…å®¹label,å¤šè¡Œæ˜¾ç¤º
    _contentLabel.numberOfLines = 0;
    [self.contentView addSubview:_contentLabel];
    [_contentLabel mas_makeConstraints:^(MASConstraintMaker *make) {
        make.left.mas_equalTo(self.nameLabel);
        make.top.mas_equalTo(self.nameLabel.mas_bottom).offset(6);
    }];
    //æ ‡é¢˜Label,ä¸€è¡Œæ˜¾ç¤º
    [_companyLabel mas_makeConstraints:^(MASConstraintMaker *make) {
        make.left.mas_equalTo(self.contentLabel);
        make.right.mas_lessThanOrEqualTo(self.contentView).offset(-10);
        make.top.mas_equalTo(self.contentLabel.mas_bottom).offset(6);
        make.bottom.mas_equalTo(self.contentView).offset(-10);//è®¾å®šäº†è¿™ä¸ªè‡ªåŠ¨è®¡ç®—cellé«˜åº¦æ—¶æ‰çŸ¥é“å…·ä½“cellçš„é«˜åº¦
    }];

    [_nameLabel setContentHuggingPriority:UILayoutPriorityRequired forAxis:UILayoutConstraintAxisVertical];
    [_companyLabel setContentHuggingPriority:UILayoutPriorityRequired forAxis:UILayoutConstraintAxisVertical];
    [_contentLabel setContentHuggingPriority:UILayoutPriorityRequired forAxis:UILayoutConstraintAxisVertical];  
</code></pre>

<p>ä¸Šé¢çš„ä»£ç ä¸­è®¾ç½®äº†å‡ ä¸ª<code>UILabel</code>çš„<code>å†…å®¹å¸é™„</code>ä¼˜å…ˆçº§ä¸ºæœ€é«˜ï¼Œè¿™æ ·å®ƒä»¬å°±ä¸ä¼šéšç€cellé«˜åº¦çš„å˜åŒ–è€Œæ‹‰ä¼¸é«˜åº¦ã€‚ä¸Šé¢è®¾ç½®äº†<code>contentLabel</code>çš„<code>numberOfLines = 0</code>ï¼Œè¿˜éœ€è¦è®¾ç½®<code>preferredMaxLayoutWidth</code>æ‰èƒ½æ­£ç¡®æ¢è¡Œæ˜¾ç¤ºã€‚ç”±äº<code>UITableViewCell</code>åœ¨æ˜¾ç¤ºå‡ºæ¥ä¹‹å‰æ˜¯ä¸çŸ¥é“å®½åº¦çš„ï¼Œä½†æ˜¯ä¸ºäº†è·å–æ­£ç¡®çš„å®½åº¦æˆ‘ä»¬å¯ä»¥åœ¨<code>- (void)layoutSubviews</code>æ–¹æ³•é‡Œé¢è®¾ç½®ï¼š</p>

<pre><code>- (void)layoutSubviews
{
    _contentLabel.preferredMaxLayoutWidth = CGRectGetWidth(self.contentView.frame) - 128 - 10 - 6;//åé¢çš„æ•°å­—æ˜¯å‰åä»¥åŠå›¾ç‰‡çš„å®½åº¦
    [super layoutSubviews];//è¿™ä¸ªè°ƒç”¨æ˜¯ä¸ºäº†æ”¹å˜åæ›´æ–°å¸ƒå±€
}
</code></pre>

<p>è¿™æ ·æˆ‘ä»¬è®¾ç½®å¥½cellä»¥åŠModelä»¥åï¼Œå…¶ä»–çš„æ–¹æ³•éƒ½å’Œæ™®é€šçš„ä½¿ç”¨ä¸€æ ·ï¼Œå”¯ä¸€ä¸ä¸€æ ·çš„å°±æ˜¯è®¡ç®—cellé«˜åº¦çš„<code>UITableView</code>ä»£ç†æ–¹æ³•<code>heightForRowAtIndexPath</code>ï¼Œå®ƒçš„å®ç°å¦‚ä¸‹ï¼š</p>

<pre><code>- (CGFloat)tableView:(UITableView *)tableView heightForRowAtIndexPath:(NSIndexPath *)indexPath
{
    static CodeLayoutCell *singleCell = nil;
    static dispatch_once_t onceToken;
    dispatch_once(&amp;onceToken, ^{
    //è¿™é‡ŒæŒæœ‰ä¸€ä¸ªcellæ˜¯ä¸ºäº†ä¸‹é¢è‡ªåŠ¨è®¡ç®—cellé«˜åº¦çš„éœ€è¦
        singleCell = [tableView dequeueReusableCellWithIdentifier:kCellIdentifier];
    });
    //å–å‡ºModelï¼Œå¦‚æœæœ‰ç¼“å­˜çš„é«˜åº¦å€¼å°±ä¸è®¡ç®—äº†
    CellModel *model = _dataSourceArray[indexPath.row];
    if (model.cacheHeight != 0) {
        return model.cacheHeight;
    }
    [singleCell layoutIfNeeded];//å¼ºåˆ¶å¸ƒå±€ï¼Œå¾—åˆ°contentViewçš„å®½åº¦
    [singleCell setNewCellModel:model];
    //ç”±ç³»ç»Ÿæ ¹æ®æˆ‘ä»¬è®¾å®šçš„Layoutè§„åˆ™æ¥è®¡ç®—cellæ˜¾ç¤ºçš„Size
    CGSize size = [singleCell.contentView systemLayoutSizeFittingSize:UILayoutFittingCompressedSize];
    model.cacheHeight = size.height + 1;//cellå’Œcell.contentViewçš„é«˜åº¦ç›¸å·®1

    return model.cacheHeight;
}  
</code></pre>

<p>è¿è¡Œçš„æ•ˆæœå¦‚ä¸‹ï¼š</p>

<p><img src="http://ww3.sinaimg.cn/mw690/8f7a6fe0gw1eyvfxuuzclg208u0d51kx.gif" alt="image" /></p>

<p>å½“å›¾ç‰‡çš„é«˜åº¦å¤§äºä¸‰ä¸ª<code>UIlabel</code>åŠ ä¸Šå„è‡ªä¸Šä¸‹çš„é—´éš”çš„é«˜åº¦æ—¶ï¼Œç”±äºæˆ‘ä»¬è®¾ç½®äº†ä¸‰ä¸ªLabelçš„<code>å†…å®¹å¸é™„</code>æœ€é«˜çš„ä¼˜å…ˆçº§ï¼Œæ‰€ä»¥ä¸ºäº†æ»¡è¶³å®ƒä»¬çš„é«˜åº¦ï¼Œå›¾ç‰‡çš„å†…å®¹å°±è¿›è¡Œäº†å‹ç¼©ï¼Œå¦‚ä¸‹:</p>

<p><img src="http://ww3.sinaimg.cn/mw690/8f7a6fe0gw1eyvfxtyebuj208w0dbdhk.jpg" alt="image" /></p>

<p>ç¬¬äºŒä¸ªcellçš„å›¾ç‰‡è¢«å‹ç¼©äº†ï¼Œå¦‚ä½•æ‰èƒ½ä¿è¯å®ƒä¸è¢«å‹ç¼©å‘¢ï¼Ÿç•™ç»™è¯»åˆ°è¿™é‡Œçš„äººè‡ªå·±å®ç°å§ï¼ğŸ˜„</p>

<p>æš‚æ—¶å…ˆå†™åˆ°è¿™é‡Œå§ï¼Œç”±äºåˆšæ¥è§¦è¿™ä¸¤ä¸ªå±æ€§ï¼Œéš¾å…ä¼šæœ‰é—è¯¯ä¹‹å¤„ï¼Œè¯·å¤§å®¶å¤šå¤šè°…è§£ï¼</p>

<p>å®Œæ•´çš„Demoï¼Œè¯·æˆ³<a href="https://github.com/liangwei518/AutolayoutDemo1">è¿™é‡Œ</a></p>
</div>


  <footer>
    <p class="meta">
      
  

<span class="byline author vcard">Posted by <span class="fn">æ¢ç‚œV</span></span>

      




<time class='entry-date' datetime='2015-12-13T17:07:53+08:00'><span class='date'>2015 å¹´12 æœˆ13 æ—¥</span> <span class='time'>5:07 pm</span></time>
      


    </p>
    
      <div class="sharing">
  
  <a href="//twitter.com/share" class="twitter-share-button" data-url="http://summertreee.github.io/blog/2015/12/13/contentcompressionresistancehe-contenthuggingxiang-jie/" data-via="" data-counturl="http://summertreee.github.io/blog/2015/12/13/contentcompressionresistancehe-contenthuggingxiang-jie/" >Tweet</a>
  
  
  
</div>

    
    <p class="meta">
      
        <a class="basic-alignment left" href="/blog/2015/11/22/auto-layoutshi-yong-xiao-ji-qiao/" title="Previous Post: Auto Layoutä½¿ç”¨å°æŠ€å·§">&laquo; Auto Layoutä½¿ç”¨å°æŠ€å·§</a>
      
      
        <a class="basic-alignment right" href="/blog/2015/12/28/classes-and-metaclasses/" title="Next Post: Classes and Metaclasses">Classes and Metaclasses &raquo;</a>
      
    </p>
  </footer>
</article>

  <section>
    <h1>Comments</h1>
    <div id="disqus_thread" aria-live="polite"><noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>
  </section>

</div>

<aside class="sidebar">
  
    <section>
  <h1>æœ€æ–°æ–‡ç« </h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2016/07/25/bu-ju-mo-hua-tong-:uicolletionview/">å¸ƒå±€ä¸‡èŠ±ç­’ï¼šuicolletionview</a>
      </li>
    
      <li class="post">
        <a href="/blog/2016/06/12/ru-he-jian-ce-iphoneshe-bei-chu-yu-di-dian-liang-mo-shi/">å¦‚ä½•æ£€æµ‹iPhoneè®¾å¤‡å¤„äºä½ç”µé‡æ¨¡å¼</a>
      </li>
    
      <li class="post">
        <a href="/blog/2016/05/22/wo-suo-li-jie-de-runtime/">æˆ‘æ‰€ç†è§£çš„Runtime</a>
      </li>
    
      <li class="post">
        <a href="/blog/2016/05/03/ding-zhi-zi-ji-de-dan-yuan-ce-shi/">å®šåˆ¶è‡ªå·±çš„å•å…ƒæµ‹è¯•</a>
      </li>
    
      <li class="post">
        <a href="/blog/2016/03/28/swiftjiao-ben-bian-ji/">Swiftè„šæœ¬ç¼–è¾‘</a>
      </li>
    
  </ul>
</section>





  
</aside>


    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2016 - æ¢ç‚œV -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  

<script type="text/javascript">
      var disqus_shortname = 'summertreee';
      
        
        // var disqus_developer = 1;
        var disqus_identifier = 'http://summertreee.github.io/blog/2015/12/13/contentcompressionresistancehe-contenthuggingxiang-jie/';
        var disqus_url = 'http://summertreee.github.io/blog/2015/12/13/contentcompressionresistancehe-contenthuggingxiang-jie/';
        var disqus_script = 'embed.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = '//' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>







  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = '//platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
